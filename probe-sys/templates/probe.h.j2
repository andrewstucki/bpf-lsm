// Code generated by scripts/generate-structures - DO NOT EDIT.
// to modify, regenerate after modifying templates/probe.h.j2

#ifndef __PROBE_H
#define __PROBE_H

#include <stdint.h>
#include "probe.bpf.h"

// this header contains forward declarations
// for the userspace side of things

struct state;

{% for module in modules -%}
// begin {{module.name}}

{% set entry_point = module.structures | last %}
typedef void {{module.name}}_event_handler(void *ctx, struct bpf_{{entry_point.name}} e);

{% if entry_point.queryable -%}
void flush_{{module.name}}_filter_rule(struct state *s, struct query_bpf_{{entry_point.name}} rule);
void flush_{{module.name}}_rejection_rule(struct state *s, struct query_bpf_{{entry_point.name}} rule);
{%endif%}

// end {{module.name}}
{%- endfor %}

struct state_configuration {
  unsigned char debug;
  {% for module in modules -%}
  void *{{module.name}}_ctx;
  {{module.name}}_event_handler *{{module.name}}_handler;
  {% endfor %}
};

struct state *new_state(struct state_configuration config);
void destroy_state(struct state *self);
void poll_state(struct state *s, int timeout);
void set_process_path(struct state *s, pid_t pid, const char * file_path);

#endif /* __PROBE_H */
