syntax = "proto2";

package probe.protobuf;

option (rustproto.carllerche_bytes_for_bytes_all) = true;
option (rustproto.carllerche_bytes_for_string_all) = true;
option optimize_for = SPEED;

message BprmCheckSecurityEventEvent {
  
  required string id = 1 [json_name="id"];
  
  required string code = 2 [json_name="code"];
  
  required string kind = 3 [json_name="kind"];
  
  required string category = 4 [json_name="category"];
  
  required string action = 5 [json_name="action"];
  
  required string field_type = 6 [json_name="type"];
  
  required string module = 7 [json_name="module"];
  
  required string provider = 8 [json_name="provider"];
  
  required uint64 sequence = 9 [json_name="sequence"];
  
  required uint64 ingested = 10 [json_name="ingested"];
  
}
message BprmCheckSecurityEventProcessTarget {
  
  required string executable = 1 [json_name="executable"];
  
  required uint64 args_count = 2 [json_name="args_count"];
  
}
message BprmCheckSecurityEventProcess {
  
  required uint32 pid = 1 [json_name="pid"];
  
  required string entity_id = 2 [json_name="entity_id"];
  
  required string name = 3 [json_name="name"];
  
  required uint32 ppid = 4 [json_name="ppid"];
  
  required uint64 thread_id = 5 [json_name="thread.id"];
  
  required BprmCheckSecurityEventProcessTarget target = 6 [json_name="target"];
  
}
message BprmCheckSecurityEventUserGroup {
  
  required string id = 1 [json_name="id"];
  
  required string name = 2 [json_name="name"];
  
}
message BprmCheckSecurityEventUser {
  
  required string id = 1 [json_name="id"];
  
  required string name = 2 [json_name="name"];
  
  required BprmCheckSecurityEventUserGroup group = 3 [json_name="group"];
  
}
message BprmCheckSecurityEvent {
  
  required uint64 timestamp = 1 [json_name="@timestamp"];
  
  required BprmCheckSecurityEventEvent event = 2 [json_name="event"];
  
  required BprmCheckSecurityEventProcess process = 3 [json_name="process"];
  
  required BprmCheckSecurityEventUser user = 4 [json_name="user"];
  
}

