// Code generated by scripts/generate-structures - DO NOT EDIT.
// to modify, regenerate after modifying templates/probe.h.j2

#ifndef __PROBE_H
#define __PROBE_H

#include <stdint.h>
#include "probe.bpf.h"

// this header contains forward declarations
// for the userspace side of things

struct state;

{% for module in modules -%}
// begin {{module.name}}

{% set entry_point = module.structures | last %}
typedef void {{module.name}}_event_handler(void *ctx, unsigned long ts, struct bpf_{{entry_point.name}} e);

// end {{module.name}}
{%- endfor %}

struct state_configuration {
  unsigned int filtered_uid;
  unsigned char debug;
  {% for module in modules -%}
  void *{{module.name}}_ctx;
  {{module.name}}_event_handler *{{module.name}}_handler;
  {% endfor %}
};

struct state *new_state(struct state_configuration config);
void destroy_state(struct state *self);
void poll_state(struct state *s, int timeout);

#endif /* __PROBE_H */
